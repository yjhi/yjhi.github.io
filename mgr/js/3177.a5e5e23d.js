(self["webpackChunkvue_antd_pro"]=self["webpackChunkvue_antd_pro"]||[]).push([[3177],{42615:function(t,e,n){var a=1/0,r=9007199254740991,i="[object Arguments]",s="[object Function]",o="[object GeneratorFunction]",c="[object Symbol]",l="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,u="object"==typeof self&&self&&self.Object===Object&&self,d=l||u||Function("return this")();function f(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function m(t,e){var n=-1,a=t?t.length:0,r=Array(a);while(++n<a)r[n]=e(t[n],n,t);return r}function p(t,e){var n=-1,a=e.length,r=t.length;while(++n<a)t[r+n]=e[n];return t}var h=Object.prototype,v=h.hasOwnProperty,g=h.toString,b=d.Symbol,y=h.propertyIsEnumerable,_=b?b.isConcatSpreadable:void 0,k=Math.max;function w(t,e,n,a,r){var i=-1,s=t.length;n||(n=x),r||(r=[]);while(++i<s){var o=t[i];e>0&&n(o)?e>1?w(o,e-1,n,a,r):p(r,o):a||(r[r.length]=o)}return r}function j(t,e){return t=Object(t),O(t,e,(function(e,n){return n in t}))}function O(t,e,n){var a=-1,r=e.length,i={};while(++a<r){var s=e[a],o=t[s];n(o,s)&&(i[s]=o)}return i}function C(t,e){return e=k(void 0===e?t.length-1:e,0),function(){var n=arguments,a=-1,r=k(n.length-e,0),i=Array(r);while(++a<r)i[a]=n[e+a];a=-1;var s=Array(e+1);while(++a<e)s[a]=n[a];return s[e]=i,f(t,this,s)}}function x(t){return A(t)||P(t)||!!(_&&t&&t[_])}function S(t){if("string"==typeof t||F(t))return t;var e=t+"";return"0"==e&&1/t==-a?"-0":e}function P(t){return T(t)&&v.call(t,"callee")&&(!y.call(t,"callee")||g.call(t)==i)}var A=Array.isArray;function R(t){return null!=t&&I(t.length)&&!E(t)}function T(t){return $(t)&&R(t)}function E(t){var e=Z(t)?g.call(t):"";return e==s||e==o}function I(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=r}function Z(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function $(t){return!!t&&"object"==typeof t}function F(t){return"symbol"==typeof t||$(t)&&g.call(t)==c}var L=C((function(t,e){return null==t?{}:j(t,m(w(e,1),S))}));t.exports=L},96503:function(t,e,n){"use strict";n.d(e,{CZ:function(){return c},JV:function(){return i},Zu:function(){return o},qM:function(){return s}});var a=n(50340),r={user:"/user",role:"/role",service:"/service",permission:"/permission",permissionNoPager:"/permission/no-pager",orgTree:"/org/tree"};function i(t){return(0,a.ZP)({url:r.role,method:"get",params:t})}function s(t){return(0,a.ZP)({url:r.service,method:"get",params:t})}function o(t){return(0,a.ZP)({url:r.permissionNoPager,method:"get",params:t})}function c(t){return(0,a.ZP)({url:r.orgTree,method:"get",params:t})}},13177:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return y}});var a=function(){var t=this,e=t._self._c;return e("a-card",{attrs:{bordered:!1}},[e("div",{staticClass:"table-page-search-wrapper"},[e("a-form",{attrs:{layout:"inline"}},[e("a-row",{attrs:{gutter:48}},[e("a-col",{attrs:{md:8,sm:24}},[e("a-form-item",{attrs:{label:"角色ID"}},[e("a-input",{attrs:{placeholder:"请输入"}})],1)],1),e("a-col",{attrs:{md:8,sm:24}},[e("a-form-item",{attrs:{label:"状态"}},[e("a-select",{attrs:{placeholder:"请选择","default-value":"0"}},[e("a-select-option",{attrs:{value:"0"}},[t._v("全部")]),e("a-select-option",{attrs:{value:"1"}},[t._v("正常")]),e("a-select-option",{attrs:{value:"2"}},[t._v("禁用")])],1)],1)],1),e("a-col",{attrs:{md:8,sm:24}},[e("span",{staticClass:"table-page-search-submitButtons"},[e("a-button",{attrs:{type:"primary"}},[t._v("查询")]),e("a-button",{staticStyle:{"margin-left":"8px"}},[t._v("重置")])],1)])],1)],1)],1),e("s-table",{ref:"table",attrs:{size:"default",columns:t.columns,data:t.loadData},scopedSlots:t._u([{key:"expandedRowRender",fn:function(n){return e("div",{staticStyle:{margin:"0"}},[e("a-row",{style:{marginBottom:"12px"},attrs:{gutter:24}},t._l(n.permissions,(function(n,a){return e("a-col",{key:a,style:{marginBottom:"12px"},attrs:{span:12}},[e("a-col",{attrs:{span:4}},[e("span",[t._v(t._s(n.permissionName)+"：")])]),n.actionEntitySet.length>0?e("a-col",{attrs:{span:20}},t._l(n.actionEntitySet,(function(n,a){return e("a-tag",{key:a,attrs:{color:"cyan"}},[t._v(t._s(n.describe))])})),1):e("a-col",{attrs:{span:20}},[t._v("-")])],1)})),1)],1)}},{key:"action",fn:function(n,a){return e("span",{},[e("a",{on:{click:function(e){return t.$refs.modal.edit(a)}}},[t._v("编辑")]),e("a-divider",{attrs:{type:"vertical"}}),e("a-dropdown",[e("a",{staticClass:"ant-dropdown-link"},[t._v(" 更多 "),e("a-icon",{attrs:{type:"down"}})],1),e("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[e("a-menu-item",[e("a",{attrs:{href:"javascript:;"}},[t._v("详情")])]),e("a-menu-item",[e("a",{attrs:{href:"javascript:;"}},[t._v("禁用")])]),e("a-menu-item",[e("a",{attrs:{href:"javascript:;"}},[t._v("删除")])])],1)],1)],1)}}])}),e("role-modal",{ref:"modal",on:{ok:t.handleOk}})],1)},r=[],i=(n(59241),n(99752),n(54286),n(75811)),s=function(){var t=this,e=t._self._c;return e("a-modal",{attrs:{title:"操作",width:800,visible:t.visible,confirmLoading:t.confirmLoading},on:{ok:t.handleOk,cancel:t.handleCancel}},[e("a-steps",{attrs:{current:1}},[e("a-step",[e("template",{slot:"title"},[t._v(" Finished ")]),e("span",{attrs:{slot:"description"},slot:"description"},[t._v("This is a description.")])],2),e("a-step",{attrs:{title:"In Progress",description:"This is a description."}}),e("a-step",{attrs:{title:"Waiting",description:"This is a description."}})],1)],1)},o=[],c=n(96503),l=n(42615),u=n.n(l),d={name:"RoleModal",data:function(){return{labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:16}},visible:!1,confirmLoading:!1,mdl:{},form:this.$form.createForm(this),permissions:[]}},created:function(){this.loadPermissions()},methods:{add:function(){this.edit({id:0})},edit:function(t){var e=this;if(this.mdl=Object.assign({},t),this.visible=!0,this.mdl.permissions&&this.permissions){var n={};this.mdl.permissions.forEach((function(t){n[t.permissionId]=t.actionEntitySet.map((function(t){return t.action}))})),this.permissions.forEach((function(t){t.selected=n[t.id]||[]}))}this.$nextTick((function(){e.form.setFieldsValue(u()(e.mdl,"id","name","status","describe"))}))},close:function(){this.$emit("close"),this.visible=!1},handleOk:function(){var t=this;this.form.validateFields((function(e,n){e||(t.confirmLoading=!0,new Promise((function(t){setTimeout((function(){return t()}),2e3)})).then((function(){t.$message.success("保存成功"),t.$emit("ok")})).catch((function(){})).finally((function(){t.confirmLoading=!1,t.close()})))}))},handleCancel:function(){this.close()},onChangeCheck:function(t){t.indeterminate=!!t.selected.length&&t.selected.length<t.actionsOptions.length,t.checkedAll=t.selected.length===t.actionsOptions.length},onChangeCheckAll:function(t,e){Object.assign(e,{selected:t.target.checked?e.actionsOptions.map((function(t){return t.value})):[],indeterminate:!1,checkedAll:t.target.checked})},loadPermissions:function(){var t=this;(0,c.Zu)().then((function(e){var n=e.result;t.permissions=n.map((function(t){var e=JSON.parse(t.actionData)||[];return t.checkedAll=!1,t.selected=[],t.indeterminate=!1,t.actionsOptions=e.map((function(t){return{label:t.describe,value:t.action}})),t}))}))}}},f=d,m=n(78302),p=(0,m.Z)(f,s,o,!1,null,"670742e4",null),h=p.exports,v={name:"TableList",components:{STable:i.m7,RoleModal:h},data:function(){var t=this;return{description:"列表使用场景：后台管理中的权限管理以及角色管理，可用于基于 RBAC 设计的角色权限控制，颗粒度细到每一个操作类型。",visible:!1,form:null,mdl:{},advanced:!1,queryParam:{},columns:[{title:"唯一识别码",dataIndex:"id"},{title:"角色名称",dataIndex:"name"},{title:"状态",dataIndex:"status"},{title:"创建时间",dataIndex:"createTime",sorter:!0},{title:"操作",width:"150px",dataIndex:"action",scopedSlots:{customRender:"action"}}],loadData:function(e){return t.$http.get("/role",{params:Object.assign(e,t.queryParam)}).then((function(t){return t.result}))},selectedRowKeys:[],selectedRows:[]}},methods:{handleEdit:function(t){this.mdl=Object.assign({},t),this.mdl.permissions.forEach((function(t){t.actionsOptions=t.actionEntitySet.map((function(t){return{label:t.describe,value:t.action,defaultCheck:t.defaultCheck}}))})),this.visible=!0},handleOk:function(){this.$refs.table.refresh()},onChange:function(t,e){this.selectedRowKeys=t,this.selectedRows=e},toggleAdvanced:function(){this.advanced=!this.advanced}},watch:{}},g=v,b=(0,m.Z)(g,a,r,!1,null,null,null),y=b.exports}}]);